@using System.Security.Claims
@{
    ViewData["Title"] = "Home";
    var greeting = "Good " + (DateTime.Now.Hour < 12 ? "Morning" : DateTime.Now.Hour < 18 ? "Afternoon" : "Evening");
    var salesUnits = ViewBag.SalesUnits as List<Unit>;
}

<div class="modern-container home-page">
    <div class="modern-page-header">
        <div class="modern-page-header-content">
            <div class="modern-greeting-icon">
                <i class="fas fa-sun"></i>
            </div>
            <h1 class="modern-page-title">
                @greeting, <span class="modern-user-name">@User.Identity?.Name!</span>
            </h1>
            <p class="modern-page-subtitle">
                Welcome to FGI CRM System. Here's what you can do today.
            </p>
        </div>
    </div>

    @if (ViewBag.UserRole == "Admin")
    {
        <div class="modern-dashboard-grid">
            <a asp-controller="Admin" asp-action="Users" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-users-cog"></i>
                </div>
                <h3 class="modern-dashboard-card-title">User Management</h3>
                <p class="modern-dashboard-card-description">Manage system users and permissions</p>
            </a>

            <a asp-controller="Admin" asp-action="Projects" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-building"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Projects</h3>
                <p class="modern-dashboard-card-description">Manage projects and properties</p>
            </a>

            <a asp-controller="Admin" asp-action="Leads" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-user-tie"></i>
                </div>
                <h3 class="modern-dashboard-card-title">All Leads</h3>
                <p class="modern-dashboard-card-description">Manage all leads across the system</p>
            </a>

            <a asp-controller="Admin" asp-action="AddUnit" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-plus-square"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Add Unit</h3>
                <p class="modern-dashboard-card-description">Add new unit to project</p>
            </a>

            <a asp-controller="Admin" asp-action="Tasks" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Tasks</h3>
                <p class="modern-dashboard-card-description">Unassigned leads @(ViewBag.UnassignedLeadsCount > 0 ? $"({ViewBag.UnassignedLeadsCount})" : "")</p>
                @if (ViewBag.UnassignedLeadsCount > 0)
                {
                    <span class="modern-notification-badge">@ViewBag.UnassignedLeadsCount</span>
                }
            </a>

            <a asp-controller="Admin" asp-action="AllUnits" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="bi bi-buildings-fill"></i>
                </div>
                <h3 class="modern-dashboard-card-title">All Units</h3>
                <p class="modern-dashboard-card-description">View all units in the system</p>
            </a>

            <a asp-controller="Admin" asp-action="MyLeads" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="bi bi-person-fill-lock"></i>
                </div>
                <h3 class="modern-dashboard-card-title">My Leads</h3>
                <p class="modern-dashboard-card-description">View your assigned leads</p>
            </a>

            <a asp-controller="Admin" asp-action="AddLead" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <h3 class="modern-dashboard-card-title">New Lead</h3>
                <p class="modern-dashboard-card-description">Create a new lead</p>
            </a>
        </div>
    }
    else if (ViewBag.UserRole == "Marketing")
    {
        <div class="modern-dashboard-grid">
            <a asp-controller="Lead" asp-action="Index" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3 class="modern-dashboard-card-title">All Leads</h3>
                <p class="modern-dashboard-card-description">Browse and manage all customer leads in the system</p>
            </a>

            <a asp-controller="Lead" asp-action="Create" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Create New Lead</h3>
                <p class="modern-dashboard-card-description">Add a new potential customer to the database</p>
            </a>

            <a asp-controller="Lead" asp-action="AddUnit" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-building"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Add New Unit</h3>
                <p class="modern-dashboard-card-description">Create and add new property units to projects</p>
            </a>

            <a asp-controller="Lead" asp-action="MyUnits" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-home"></i>
                </div>
                <h3 class="modern-dashboard-card-title">My Units</h3>
                <p class="modern-dashboard-card-description">View and manage units you've added to the system</p>
            </a>
        </div>
    }
    else if (ViewBag.UserRole == "Sales")
    {
        <div class="modern-dashboard-grid">
            <a asp-controller="Sales" asp-action="MyTasks" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <h3 class="modern-dashboard-card-title">My Tasks</h3>
                <p class="modern-dashboard-card-description">New leads assigned to you</p>
                @if (ViewBag.NewLeadsCount > 0)
                {
                    <span class="modern-notification-badge">@ViewBag.NewLeadsCount</span>
                }
            </a>

            <a asp-controller="Sales" asp-action="MyLeads" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3 class="modern-dashboard-card-title">My Leads</h3>
                <p class="modern-dashboard-card-description">Leads you're actively working on and managing</p>
            </a>

            <a asp-controller="Sales" asp-action="MyUnits" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-home"></i>
                </div>
                <h3 class="modern-dashboard-card-title">My Units</h3>
                <p class="modern-dashboard-card-description">Property units assigned to you for sales</p>
            </a>

            <a asp-controller="Sales" asp-action="AddUnit" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-plus-square"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Add Unit</h3>
                <p class="modern-dashboard-card-description">Create and add new property units to inventory</p>
            </a>

            <a asp-controller="Sales" asp-action="AvailableUnits" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="bi bi-buildings-fill"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Available Units</h3>
                <p class="modern-dashboard-card-description">Browse all available property units for sale</p>
            </a>

            <a asp-controller="Sales" asp-action="LeadDetails" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Lead Analytics</h3>
                <p class="modern-dashboard-card-description">View detailed analytics and performance metrics</p>
            </a>
        </div>
    }
</div>

@section Scripts {
    <script src="~/js/home.js" asp-append-version="true"></script>
}
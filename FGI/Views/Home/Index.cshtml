@using System.Security.Claims
@{
    ViewData["Title"] = "Home";
    var greeting = "Good " + (DateTime.Now.Hour < 12 ? "Morning" : DateTime.Now.Hour < 18 ? "Afternoon" : "Evening");
    var salesUnits = ViewBag.SalesUnits as List<Unit>;
}


<div class="modern-container">
    <div class="modern-page-header">
        <h1 class="modern-page-title">@greeting, <span class="font-bold">@User.Identity?.Name!</span></h1>
        <p class="modern-page-subtitle">Welcome to FGI CRM System. Here's what you can do today.</p>
    </div>

    @if (ViewBag.UserRole == "Admin")
    {
        <div class="modern-dashboard-grid">
            <a asp-controller="Admin" asp-action="Users" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-users-cog"></i>
                </div>
                <h3 class="modern-dashboard-card-title">User Management</h3>
                <p class="modern-dashboard-card-description">Manage system users and permissions</p>
            </a>

            <a asp-controller="Admin" asp-action="Projects" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-building"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Projects</h3>
                <p class="modern-dashboard-card-description">Manage projects and properties</p>
            </a>

            <a asp-controller="Admin" asp-action="Leads" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-user-tie"></i>
                </div>
                <h3 class="modern-dashboard-card-title">All Leads</h3>
                <p class="modern-dashboard-card-description">Manage all leads across the system</p>
            </a>

            <a asp-controller="Admin" asp-action="AddUnit" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-plus-square"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Add Unit</h3>
                <p class="modern-dashboard-card-description">Add new unit to project</p>
            </a>

            <a asp-controller="Admin" asp-action="Tasks" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <h3 class="modern-dashboard-card-title">Tasks</h3>
                <p class="modern-dashboard-card-description">Unassigned leads @(ViewBag.UnassignedLeadsCount > 0 ? $"({ViewBag.UnassignedLeadsCount})" : "")</p>
            </a>

            <a asp-controller="Admin" asp-action="AllUnits" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="bi bi-buildings-fill"></i>
                </div>
                <h3 class="modern-dashboard-card-title">All Units</h3>
                <p class="modern-dashboard-card-description">View all units in the system</p>
            </a>

            <a asp-controller="Admin" asp-action="MyLeads" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="bi bi-person-fill-lock"></i>
                </div>
                <h3 class="modern-dashboard-card-title">My Leads</h3>
                <p class="modern-dashboard-card-description">View your assigned leads</p>
            </a>

            <a asp-controller="Admin" asp-action="AddLead" class="modern-dashboard-card">
                <div class="modern-dashboard-card-icon">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <h3 class="modern-dashboard-card-title">New Lead</h3>
                <p class="modern-dashboard-card-description">Create a new lead</p>
            </a>
        </div>
    }
    else if (ViewBag.UserRole == "Marketing")
    {
        <div class="row">
            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="Index" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-user-tie"></i>
                        <h5 class="card-title">Leads</h5>
                        <p class="card-text">View all leads</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="Create" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-circle"></i>
                        <h5 class="card-title">New Lead</h5>
                        <p class="card-text">Create new lead</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="AddUnit" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-square"></i>
                        <h5 class="card-title">Add Unit</h5>
                        <p class="card-text">Add new unit to project</p>
                    </div>
                </a>
            </div>

            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="MyUnits" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body position-relative">
                        <i class="fas fa-home"></i>
                        <h5 class="card-title">My Units</h5>
                        <p class="card-text">View your units</p>
                    </div>
                </a>
            </div>
        </div>
    }
    else if (ViewBag.UserRole == "Sales")
    {
        <div class="row justify-content-center">
            <!-- My Tasks Button -->
            <div class="col-md-4 mb-4">
                <div class="position-relative">
                    <a asp-controller="Sales" asp-action="MyTasks" class="card dashboard-card card-sales text-decoration-none">
                        <div class="card-body position-relative">
                            <i class="fas fa-tasks"></i>
                            <h5 class="card-title">My Tasks</h5>
                            <p class="card-text">New leads assigned to you</p>
                            @if (ViewBag.NewLeadsCount > 0)
                            {
                                <span class="notification-badge">@ViewBag.NewLeadsCount</span>
                            }
                        </div>
                    </a>
                </div>
            </div>

            <!-- My Leads Button -->
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="MyLeads" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body position-relative">
                        <i class="fas fa-users"></i>
                        <h5 class="card-title">My Leads</h5>
                        <p class="card-text">Leads you're working on</p>
                    </div>
                </a>
            </div>

            <!-- My Units Button -->
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="MyUnits" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body position-relative">
                        <i class="fas fa-home"></i>
                        <h5 class="card-title">My Units</h5>
                        <p class="card-text">View your units</p>
                    </div>
                </a>
            </div>

            <!-- Add Unit Button -->
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="AddUnit" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-square"></i>
                        <h5 class="card-title">Add Unit</h5>
                        <p class="card-text">Add new unit</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="AvailableUnits" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body">
                        <i class="bi bi-buildings-fill"></i>
                        <h5 class="card-title">Our Units</h5>
                        <p class="card-text">See Available all units</p>
                    </div>
                </a>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script src="~/js/home.js" asp-append-version="true"></script>
}
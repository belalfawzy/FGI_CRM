@using System.Security.Claims
@{
    ViewData["Title"] = "Home";
    var greeting = "Good " + (DateTime.Now.Hour < 12 ? "Morning" : DateTime.Now.Hour < 18 ? "Afternoon" : "Evening");
    var salesUnits = ViewBag.SalesUnits as List<Unit>;
}

@section Styles {
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true">
}

<div class="container py-4">
    <div class="greeting-card">
        <div class="greeting-content">
            <h1 class="display-4 mb-2">@greeting, <span class="fw-bold">@User.Identity?.Name!</span></h1>
            <p class="lead mb-0">Welcome to FGI CRM System. Here's what you can do today.</p>
        </div>
    </div>

    @if (ViewBag.UserRole == "Admin")
    {
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="position-relative">
                    <a asp-controller="Admin" asp-action="Users" class="card dashboard-card card-admin text-decoration-none">
                        <div class="card-body">
                            <i class="fas fa-users-cog"></i>
                            <h5 class="card-title">User Management</h5>
                            <p class="card-text">Manage system users</p>
                        </div>
                    </a>
                </div>
            </div>

            <div class="col-md-3 mb-4">
                <div class="position-relative">
                    <a asp-controller="Admin" asp-action="Projects" class="card dashboard-card card-admin text-decoration-none">
                        <div class="card-body">
                            <i class="fas fa-building"></i>
                            <h5 class="card-title">Projects</h5>
                            <p class="card-text">Manage projects</p>
                        </div>
                    </a>
                </div>
            </div>

            <div class="col-md-3 mb-4">
                <div class="position-relative">
                    <a asp-controller="Admin" asp-action="Leads" class="card dashboard-card card-admin text-decoration-none">
                        <div class="card-body">
                            <i class="fas fa-user-tie"></i>
                            <h5 class="card-title">All Leads</h5>
                            <p class="card-text">Manage all leads</p>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <a asp-controller="Admin" asp-action="AddUnit" class="card dashboard-card card-admin text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-square"></i>
                        <h5 class="card-title">Add Unit</h5>
                        <p class="card-text">Add new unit to project</p>
                    </div>
                </a>
            </div>

            <div class="col-md-3 mb-4">
                <div class="position-relative">
                    <a asp-controller="Admin" asp-action="Tasks" class="card dashboard-card card-admin text-decoration-none">
                        <div class="card-body">
                            <i class="fas fa-tasks"></i>
                            <h5 class="card-title">Tasks</h5>
                            <p class="card-text">Unassigned leads</p>
                        </div>
                        @if (ViewBag.UnassignedLeadsCount > 0)
                        {
                            <span class="notification-badge">
                                @ViewBag.UnassignedLeadsCount
                            </span>
                        }
                    </a>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <a asp-controller="Admin" asp-action="AllUnits" class="card dashboard-card card-admin text-decoration-none">
                    <div class="card-body">
                        <i class="bi bi-buildings-fill"></i>
                        <h5 class="card-title">All Units</h5>
                        <p class="card-text">See all units</p>
                    </div>
                </a>
            </div>
            <div class="col-md-3 mb-4">
                <a asp-controller="Admin" asp-action="MyLeads" class="card dashboard-card card-admin text-decoration-none">
                    <div class="card-body">
                        <i class="bi bi-person-fill-lock"></i>
                        <h5 class="card-title">My Leads</h5>
                        <p class="card-text">View your own leads</p>
                    </div>
                </a>
            </div>
            <div class="col-md-3 mb-4">
                <a asp-controller="Admin" asp-action="AddLead" class="card dashboard-card card-admin text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-circle"></i>
                        <h5 class="card-title">New Lead</h5>
                        <p class="card-text">Create new lead</p>
                    </div>
                </a>
            </div>
        </div>
    }
    else if (ViewBag.UserRole == "Marketing")
    {
        <div class="row">
            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="Index" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-user-tie"></i>
                        <h5 class="card-title">Leads</h5>
                        <p class="card-text">View all leads</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="Create" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-circle"></i>
                        <h5 class="card-title">New Lead</h5>
                        <p class="card-text">Create new lead</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="AddUnit" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-square"></i>
                        <h5 class="card-title">Add Unit</h5>
                        <p class="card-text">Add new unit to project</p>
                    </div>
                </a>
            </div>

            <div class="col-md-4 mb-4">
                <a asp-controller="Lead" asp-action="MyUnits" class="card dashboard-card card-marketing text-decoration-none">
                    <div class="card-body position-relative">
                        <i class="fas fa-home"></i>
                        <h5 class="card-title">My Units</h5>
                        <p class="card-text">View your units</p>
                    </div>
                </a>
            </div>
        </div>
    }
    else if (ViewBag.UserRole == "Sales")
    {
        <div class="row justify-content-center">
            <!-- My Tasks Button -->
            <div class="col-md-4 mb-4">
                <div class="position-relative">
                    <a asp-controller="Sales" asp-action="MyTasks" class="card dashboard-card card-sales text-decoration-none">
                        <div class="card-body position-relative">
                            <i class="fas fa-tasks"></i>
                            <h5 class="card-title">My Tasks</h5>
                            <p class="card-text">New leads assigned to you</p>
                            @if (ViewBag.NewLeadsCount > 0)
                            {
                                <span class="notification-badge">@ViewBag.NewLeadsCount</span>
                            }
                        </div>
                    </a>
                </div>
            </div>

            <!-- My Leads Button -->
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="MyLeads" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body position-relative">
                        <i class="fas fa-users"></i>
                        <h5 class="card-title">My Leads</h5>
                        <p class="card-text">Leads you're working on</p>
                    </div>
                </a>
            </div>

            <!-- My Units Button -->
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="MyUnits" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body position-relative">
                        <i class="fas fa-home"></i>
                        <h5 class="card-title">My Units</h5>
                        <p class="card-text">View your units</p>
                    </div>
                </a>
            </div>

            <!-- Add Unit Button -->
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="AddUnit" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body">
                        <i class="fas fa-plus-square"></i>
                        <h5 class="card-title">Add Unit</h5>
                        <p class="card-text">Add new unit</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a asp-controller="Sales" asp-action="AvailableUnits" class="card dashboard-card card-sales text-decoration-none">
                    <div class="card-body">
                        <i class="bi bi-buildings-fill"></i>
                        <h5 class="card-title">Our Units</h5>
                        <p class="card-text">See Available all units</p>
                    </div>
                </a>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script src="~/js/home.js" asp-append-version="true"></script>
}